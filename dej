#!/bin/sh

# You may copy this file, but moving it causes problems.

# Source directory
src="./"
cd $src;

# Prints a message with a new line at end
printfl () {
    printf "$1\n"
}

# Helps path
helps="data/helps"

# Errors while entering commands
moreInfo="Try 'dej --help' for more information."

commandExpectedError=\
"You must specify a command.
$moreInfo"

badUsageError=\
"Bad usage.
$moreInfo"

unknownCommandError=\
"Unknown command
$moreInfo"

tooManyArgsError=\
"Too many arguments supplied!
$moreInfo"

# No arguments supplied
if [ $# -eq 0 ]; then
    printfl "$commandExpectedError"

# An arguments supplied
elif [ $# -eq 1 ]; then
    case $1 in
        # Start PHP process for each command
        start|stop|status|restart)
            sh src/php.sh $1
            ;;
        help|-h|--help)
            printfl "`cat $helps/help.txt`";
            ;;
        config)
            printfl "$badUsageError"
            ;;
        *)
            printfl "$unknownCommandError"
            ;;
    esac

# Two arguments supplied
elif [ $# -eq 2 ]; then
    case $1 in
        # User wants help on specific command
        --help|-h|help)
            case $2 in
                # Print help for each command
                start|stop|restart|status|config)
                    printfl "`cat $helps/$2.txt`"
                    ;;
                *)
                    printfl "$unknownCommandError"
                    ;;
            esac
            ;;
        start|stop|restart|status)
            case $2 in
                --help|-h|help)
                    printfl "`cat $helps/$1.txt`"
                    ;;
                *)
                    printfl "$badUsageError"
                    ;;
            esac
            ;;
        config)
            case $2 in
                # User wants a list of available fields
                list)
                    printfl "`cat $helps/config_list.txt`"
                    ;;
                # User wants to create the configuration file
                create)
                    printfl "Creating configuration file..."
                    mkdir config >/dev/null 2>&1
                    touch config/data.json
                    printfl "Created successfully."
                    ;;
                *)
                    printfl "$badUsageError"
                    ;;
            esac
            ;;
        *)
            printfl "$unknownCommandError"
            ;;
    esac

# Three arguments supplied
elif [ $# -eq 3 ]; then
    case $1 in
        --help|start|stop|restart|status)
            printfl "$badUsageError"
            ;;
        # Change the configuration file (i.e. config/data.json)
        config)
            sh src/php.sh config $2 $3
            ;;
        *)
            printfl "$unknownCommandError"
            ;;
    esac

# Too many arguments (> 3)
else
    printfl "$tooManyArgsError"
fi